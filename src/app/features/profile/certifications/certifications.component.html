<section class="certifications-section" [attr.data-theme]="theme">
  <!-- Certification Row -->
  <div
    #certGrid
    class="cert-row"
    [ngClass]="{
      'auto-scrolling': isAutoScrolling && !isDragging,
      dragging: isDragging
    }"
    (mousedown)="onDragStart($event)"
    (touchstart)="onTouchStart($event)"
    (mouseenter)="pauseAutoScroll()"
    (mouseleave)="resumeAutoScroll()"
  >
    <!-- Certification Cards -->
    <div
      class="cert-card"
      *ngFor="
        let cert of displayCertifications;
        trackBy: trackByCert;
        let i = index
      "
      [attr.data-index]="i"
      [attr.draggable]="false"
      (mousedown)="onCardDragStart($event)"
      (touchstart)="onCardTouchStart($event)"
      (selectstart)="onSelectStart($event)"
    >
      <!-- Certificate Icon -->
      <div class="cert-icon">
        <!-- Main icon - always visible -->
        <img
          [src]="cert.icon"
          [alt]="cert.name + ' certification logo'"
          loading="eager"
          decoding="sync"
          fetchpriority="high"
          (load)="onImageLoad(cert)"
          (error)="onImageError($event, cert)"
          (dragstart)="$event.preventDefault()"
          *ngIf="!cert.iconError"
        />

        <!-- Fallback icon - shown only on error -->
        <div
          class="fallback-icon"
          *ngIf="cert.iconError"
          [attr.aria-label]="cert.name + ' certification'"
        >
          <!-- Enhanced fallback icon based on cert type -->
          <svg
            viewBox="0 0 24 24"
            fill="currentColor"
            *ngIf="cert.type === 'certification'"
          >
            <path
              d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
            />
          </svg>

          <svg
            viewBox="0 0 24 24"
            fill="currentColor"
            *ngIf="cert.type === 'course'"
          >
            <path d="M12 3L1 9l11 6 9-4.91V17h2V9L12 3z" />
            <path d="M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82z" />
          </svg>

          <svg
            viewBox="0 0 24 24"
            fill="currentColor"
            *ngIf="cert.type === 'bootcamp'"
          >
            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>

          <!-- Default fallback -->
          <svg
            viewBox="0 0 24 24"
            fill="currentColor"
            *ngIf="
              !cert.type ||
              (cert.type !== 'certification' &&
                cert.type !== 'course' &&
                cert.type !== 'bootcamp')
            "
          >
            <path d="M12 2L3 7l9 5 9-5-9-5zM3 17l9 5 9-5M3 12l9 5 9-5" />
          </svg>
        </div>
      </div>

      <!-- Certificate Content -->
      <div
        class="cert-content"
        (mousedown)="onContentDragStart($event)"
        (touchstart)="onContentTouchStart($event)"
      >
        <h4
          class="cert-title"
          [title]="cert.name"
          (mousedown)="onTitleDragStart($event)"
        >
          {{ cert.name }}
        </h4>
        <p
          class="cert-org"
          [title]="cert.issuer"
          (mousedown)="onOrgDragStart($event)"
        >
          {{ cert.issuer }}
        </p>
        <span
          class="cert-date"
          [title]="'Issued: ' + cert.date"
          (mousedown)="onDateDragStart($event)"
        >
          {{ cert.date }}
        </span>
      </div>

      <!-- Certificate Badge -->
      <span
        class="cert-badge"
        [ngClass]="cert.type"
        [title]="cert.type | titlecase"
        (mousedown)="onBadgeDragStart($event)"
      >
        {{ cert.type }}
      </span>
    </div>
  </div>
</section>
