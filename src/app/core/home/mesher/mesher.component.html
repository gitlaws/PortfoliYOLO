<div
  class="animated-mesh-container"
  [class.active]="isActive"
  [attr.data-theme]="currentTheme"
  [attr.data-performance]="performanceMode"
  [attr.data-intensity]="intensityLevel"
  #mesherContainer
>
  <!-- Main Canvas for Mesh Gradient -->
  <canvas
    #meshCanvas
    class="mesh-canvas"
    [width]="canvasWidth"
    [height]="canvasHeight"
    [attr.aria-hidden]="true"
    (mouseenter)="onMouseEnter($event)"
    (mouseleave)="onMouseLeave()"
    (mousemove)="onMouseMove($event)"
  >
    <p>Animated mesh gradient background with pastel colors</p>
  </canvas>

  <!-- Color Points Visualization (for development) -->
  <div
    class="color-points-debug"
    *ngIf="showDebugInfo && !isProduction"
    [attr.aria-hidden]="true"
  >
    <div
      class="color-point-debug"
      *ngFor="let point of colorPoints; trackBy: trackColorPoint"
      [style.left.px]="point.x"
      [style.top.px]="point.y"
      [style.background]="point.color"
      [attr.data-point-id]="point.id"
    >
      {{ point.id }}
    </div>
  </div>

  <!-- Gradient Overlay Layers -->
  <div class="gradient-layers" [attr.aria-hidden]="true">
    <div class="gradient-layer primary-layer"></div>
    <div class="gradient-layer secondary-layer"></div>
    <div class="gradient-layer accent-layer"></div>
  </div>

  <!-- Loading State -->
  <div
    class="mesh-loading"
    *ngIf="isLoading"
    [attr.aria-label]="'Loading animated mesh gradient'"
  >
    <div class="loading-gradient">
      <div class="loading-point" *ngFor="let i of [1, 2, 3, 4, 5, 6]"></div>
    </div>
  </div>

  <!-- Enhanced Debug Panel -->
  <div class="mesh-debug" *ngIf="showDebugInfo && !isProduction">
    <div class="debug-panel">
      <div class="debug-section">
        <h4>Performance</h4>
        <span>FPS: {{ currentFPS }}</span>
        <span>Frame Time: {{ averageFrameTime.toFixed(1) }}ms</span>
        <span>Render Time: {{ lastRenderTime.toFixed(1) }}ms</span>
      </div>
      <div class="debug-section">
        <h4>Mesh Gradient</h4>
        <span>Color Points: {{ colorPoints.length }}</span>
        <span>Animation Speed: {{ animationSpeed.toFixed(2) }}</span>
        <span>Morph Intensity: {{ morphIntensity.toFixed(2) }}</span>
      </div>
      <div class="debug-section">
        <h4>Mouse Interaction</h4>
        <span>Mouse Active: {{ isMouseActive }}</span>
        <span>Influence: {{ mouseInfluenceStrength.toFixed(2) }}</span>
      </div>
    </div>
  </div>
</div>
