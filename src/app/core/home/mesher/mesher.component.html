<div
  class="animated-mesh-container"
  [ngClass]="themeClasses"
  [class.active]="isActive"
  [attr.data-theme]="currentTheme"
  [attr.data-resolved-theme]="resolvedTheme"
  [attr.data-performance]="performanceMode"
  [attr.data-intensity]="intensityLevel"
  #mesherContainer
>
  <!-- Floating Orbs Background -->
  <div class="floating-orbs" [attr.aria-hidden]="true">
    <div class="orb orb-large orb-1"></div>
    <div class="orb orb-medium orb-2"></div>
    <div class="orb orb-small orb-3"></div>
    <div class="orb orb-medium orb-4"></div>
    <div class="orb orb-large orb-5"></div>
    <div class="orb orb-small orb-6"></div>
  </div>

  <!-- Main Canvas for Mesh Gradient -->
  <canvas
    #meshCanvas
    class="mesh-canvas"
    [attr.aria-hidden]="true"
    (mouseenter)="onMouseEnter($event)"
    (mouseleave)="onMouseLeave()"
    (mousemove)="onMouseMove($event)"
  >
    <p>Animated mesh gradient background with pastel colors</p>
  </canvas>

  <!-- Loading State -->
  <div
    class="mesh-loading"
    *ngIf="isLoading"
    [attr.aria-label]="'Loading animated mesh gradient'"
  >
    <div class="loading-constellation">
      <div
        class="loading-star"
        *ngFor="let i of [1, 2, 3, 4, 5, 6, 7, 8]"
      ></div>
    </div>
    <div class="loading-text">
      <span
        class="loading-letter"
        *ngFor="let letter of loadingText; let i = index"
        [style.animation-delay]="i * 0.1 + 's'"
        >{{ letter }}</span
      >
    </div>
  </div>

  <!-- Debug Panel -->
  <div class="mesh-debug" *ngIf="showDebugInfo && !isProduction">
    <div class="debug-panel">
      <div class="debug-header">
        <h3>Mesh Analytics</h3>
        <div class="debug-indicator" [class.active]="isActive"></div>
      </div>
      <div class="debug-section">
        <h4>Theme</h4>
        <div class="metric">
          <span class="metric-label">Current:</span>
          <span class="metric-value">{{ currentTheme }}</span>
        </div>
        <div class="metric">
          <span class="metric-label">Resolved:</span>
          <span class="metric-value">{{ resolvedTheme }}</span>
        </div>
        <div class="metric">
          <span class="metric-label">Classes:</span>
          <span class="metric-value">{{ themeClasses.join(" ") }}</span>
        </div>
      </div>
      <div class="debug-section">
        <h4>Performance</h4>
        <div class="metric">
          <span class="metric-label">FPS:</span>
          <span class="metric-value" [class.warning]="currentFPS < 30">{{
            currentFPS
          }}</span>
        </div>
        <div class="metric">
          <span class="metric-label">Intensity:</span>
          <span class="metric-value">{{ intensityLevel }}</span>
        </div>
      </div>
      <div class="debug-section">
        <h4>Interactive</h4>
        <div class="metric">
          <span class="metric-label">Mouse Active:</span>
          <span class="metric-value">{{ isMouseActive ? "Yes" : "No" }}</span>
        </div>
        <div class="metric">
          <span class="metric-label">Position:</span>
          <span class="metric-value"
            >{{ mousePosition?.x || 0 }}, {{ mousePosition?.y || 0 }}</span
          >
        </div>
      </div>
    </div>
  </div>

  <!-- Interactive Cursor Effect -->
  <div
    class="cursor-glow"
    *ngIf="isMouseActive && interactive"
    [style.left.px]="mousePosition?.x"
    [style.top.px]="mousePosition?.y"
    [attr.aria-hidden]="true"
  ></div>
</div>
